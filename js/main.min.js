(()=>{"use strict";var e,t,s,n,o={78:(e,t,s)=>{s.d(t,{F$:()=>a,Fx:()=>o,UD:()=>i,bM:()=>n,p:()=>r,tx:()=>c});const n=1,o=2,i=3,r=4,a=5,c=6},79:(e,t,s)=>{s.d(t,{W9:()=>u,xI:()=>l});var n=s(953),o=s(78);const i=()=>`${location.protocol}//${location.host}/`,r=e=>1e3*e+Date.now();async function a(e,t,s){const n="undefined"!=typeof location&&location;if(n&&"https:"===n.protocol){const t=document.createElement("a");if(t.href=e,"http:"===t.protocol&&"localhost"!==t.hostname)throw o.F$}const i=new FormData;null!==t&&i.append("client_id",t),Object.keys(s).forEach((e=>{i.append(e,s[e])}));const a=await fetch(`${e}/auth/token`,{method:"POST",credentials:"same-origin",body:i});if(!a.ok)throw 400===a.status||403===a.status?o.Fx:new Error("Unable to fetch tokens");const c=await a.json();return c.hassUrl=e,c.clientId=t,c.expires=r(c.expires_in),c}function c(e,t,s){return a(e,t,{code:s,grant_type:"authorization_code"})}class d{constructor(e,t){this.data=e,this._saveTokens=t}get wsUrl(){return`ws${this.data.hassUrl.substr(4)}/api/websocket`}get accessToken(){return this.data.access_token}get expired(){return Date.now()>this.data.expires}async refreshAccessToken(){if(!this.data.refresh_token)throw new Error("No refresh_token");const e=await a(this.data.hassUrl,this.data.clientId,{grant_type:"refresh_token",refresh_token:this.data.refresh_token});e.refresh_token=this.data.refresh_token,this.data=e,this._saveTokens&&this._saveTokens(e)}async revoke(){if(!this.data.refresh_token)throw new Error("No refresh_token to revoke");const e=new FormData;e.append("token",this.data.refresh_token),await fetch(`${this.data.hassUrl}/auth/revoke`,{method:"POST",credentials:"same-origin",body:e}),this._saveTokens&&this._saveTokens(null)}}function u(e,t){return new d({hassUrl:e,clientId:null,expires:Date.now()+1e11,refresh_token:"",access_token:t,expires_in:1e11})}async function l(e={}){let t,s=e.hassUrl;s&&"/"===s[s.length-1]&&(s=s.substr(0,s.length-1));const r=void 0!==e.clientId?e.clientId:i(),a=!0===e.limitHassInstance;if(e.authCode&&s&&(t=await c(s,r,e.authCode),e.saveTokens&&e.saveTokens(t)),!t){const i=(0,n.mA)(location.search.substr(1));if("auth_callback"in i){const n=(u=i.state,JSON.parse(atob(u)));if(a&&(n.hassUrl!==s||n.clientId!==r))throw o.tx;t=await c(n.hassUrl,n.clientId,i.code),e.saveTokens&&e.saveTokens(t)}}var u,l;if(!t&&e.loadTokens&&(t=await e.loadTokens()),t)return new d(t,e.saveTokens);if(void 0===s)throw o.p;return function(e,t,s,n){s+=(s.includes("?")?"&":"?")+"auth_callback=1",document.location.href=function(e,t,s,n){let o=`${e}/auth/authorize?response_type=code&redirect_uri=${encodeURIComponent(s)}`;return null!==t&&(o+=`&client_id=${encodeURIComponent(t)}`),n&&(o+=`&state=${encodeURIComponent(n)}`),o}(e,t,s,n)}(s,r,e.redirectUrl||function(){const{protocol:e,host:t,pathname:s,search:n}=location;return`${e}//${t}${s}${n}`}(),(l={hassUrl:s,clientId:r},btoa(JSON.stringify(l)))),new Promise((()=>{}))}},113:(e,t,s)=>{function n(e){return{type:"auth",access_token:e}}function o(){return{type:"supported_features",id:1,features:{coalesce_messages:1}}}function i(){return{type:"get_states"}}function r(){return{type:"auth/current_user"}}function a(e,t,s,n,o){const i={type:"call_service",domain:e,service:t,target:n,return_response:o};return s&&(i.service_data=s),i}function c(e){const t={type:"subscribe_events"};return e&&(t.event_type=e),t}function d(e){return{type:"unsubscribe_events",subscription:e}}function u(){return{type:"ping"}}function l(e,t){return{type:"result",success:!1,error:{code:e,message:t}}}s.d(t,{B1:()=>d,cb:()=>a,gQ:()=>o,hU:()=>u,j2:()=>n,kQ:()=>r,ku:()=>c,xP:()=>i,z3:()=>l})},365:(e,t,s)=>{s.d(t,{r:()=>i});var n,o=s(815);function i(e){console.log(e);let t=document.querySelector("#mediaplayer");t.classList.remove("hidden"),t.dataset.player_id=e.entity_id,console.log("Showing Media player"),document.querySelector("#container").classList.add("hidden"),null!=e.attributes.entity_picture?t.style.backgroundImage=`url("${e.attributes.entity_picture}")`:"Spotify"==e.attributes.app_name?t.style.backgroundImage="url(images/spotify.png)":"Youtube"==e.attributes.app_name&&(t.style.backgroundImage="url(images/youtube.png)"),t.querySelector(".title").textContent=e.attributes.media_title,t.querySelector("#volume-slider").value=e.attributes.volume_level,"playing"==e.state||"buffering"==e.state?(t.querySelector("#pause").classList.remove("hidden"),t.querySelector("#play").classList.add("hidden")):(t.querySelector("#pause").classList.add("hidden"),t.querySelector("#play").classList.remove("hidden")),""!=n&&clearInterval(n),t.querySelector("#progress").max=e.attributes.media_duration,t.querySelector("#progress").value=e.attributes.media_position,"playing"==e.state&&(n=setInterval((e=>t.querySelector("#progress").value=parseFloat(t.querySelector("#progress").value)+.1),100))}document.addEventListener("click",(e=>{let t=e.target,s=t.closest("span"),n=t.closest("#mediaplayer");if(null==n)return;let i=t.dataset.domain;null==i&&(i="media_player");let r,a={entity_id:n.dataset.player_id};"volume-slider"==t.id?(r="volume_set",a.volume_level=Math.min(t.value,.9)):r=null!=s?s.dataset.action:t.dataset.action,"volume_mute"==r?(console.log(s),s.querySelector("img").src.includes("volume-mute.png")?(console.log(s),a.is_volume_muted=!0,s.querySelector("img").src="images/volume-muted.png"):(console.log(s),a.is_volume_muted=!1,s.querySelector("img").src="images/volume-mute.png")):"media_seek"==r&&(a.seek_position=t.value),(0,o.cb)(connection,i,r,a)}))},564:(e,t,s)=>{s.a(e,(async(e,t)=>{try{var n=s(79),o=s(78),i=s(739),r=s(815),a=s(893),c=(s(694),s(365));let d,u;async function l(){let e;const t={async loadTokens(){try{return JSON.parse(localStorage.hassTokens)}catch(e){return}},saveTokens:e=>{localStorage.hassTokens=JSON.stringify(e)}};try{e=await(0,n.xI)(t)}catch(s){if(s!==o.p)return void alert(`Unknown error: ${s}`);if(t.hassUrl=prompt("What host to connect to?","http://localhost:8123"),!t.hassUrl)return;e=await(0,n.xI)(t)}window.connection=await(0,i.tq)({auth:e});for(const e of["disconnected","ready","reconnect-error"])window.connection.addEventListener(e,(()=>console.log(`Event: ${e}`)));location.search.includes("auth_callback=1")&&history.replaceState(null,"",location.pathname),window.auth=e,(0,r.wz)(window.connection).then((e=>{console.log("Logged in as",e),window.user=e}))}function h(e,t){document.querySelectorAll(e).forEach((e=>e.textContent=t.state+"Â°"));let s=new Date(t.last_changed),n=s.getHours(),o=s.getMinutes();o=g(o),document.querySelectorAll(e.replace("-temp","-time")).forEach((e=>e.textContent=`${n}:${o}`))}function m(e,t){let s=e.entity_id;null!=entIds.outdoor_temp&&s==entIds.outdoor_temp?(document.querySelector("#outside .tempwrapper .temp").textContent=e.state,y(e,"#outside .tempwrapper .temp")):null!=entIds.indoor_temp&&s==entIds.indoor_temp?(document.querySelector("#inside .tempwrapper .temp").textContent=e.state,y(e,"#inside .tempwrapper .temp")):null!=entIds.outdoor_hum&&s==entIds.outdoor_hum?document.querySelector("#outside .humwrapper .hum").textContent=e.state:null!=entIds.indoor_hum&&s==entIds.indoor_hum?document.querySelector("#inside .humwrapper .hum").textContent=e.state:null!=entIds.max_temp_outside&&s==entIds.max_temp_outside?h("#outside .max .max-temp",e):null!=entIds.max_temp_inside&&s==entIds.max_temp_inside?h("#inside .max .max-temp",e):null!=entIds.min_temp_outside&&s==entIds.min_temp_outside?h("#outside .min .min-temp",e):null!=entIds.min_temp_inside&&s==entIds.min_temp_inside?h("#inside .min .min-temp",e):null!=entIds.rain&&s==entIds.rain?_(e.state,t[entIds.rainrate]):null!=entIds.rainrate&&s==entIds.rainrate&&_(t[entIds.rain],e.state),["custom","footer_1","footer_2","footer_3"].forEach((t=>{if(null!=entIds[t]&&s==entIds[t]){let s="";if(null!=e.attributes.icon){let t=e.attributes.icon.replace(":","-"),n="";"on"==e.state&&(n="style=color:gold"),s=`<span class="mdi ${t}" ${n}></span>`}else s=e.state;document.querySelector(`#${t}`).innerHTML=s}}))}function p(e,t){let s=!1;null==window.entities&&(window.entities=t,s=!0);let n=!1;Object.values(t).forEach((e=>{(e.state!=window.entities[e.entity_id].state||s)&&m(e,t),!e.entity_id.includes("media_player")||"playing"!=e.state&&"buffering"!=e.state&&"paused"!=e.state||(n=!0,(0,c.r)(e))})),window.entities=t,n||(console.log("Hiding Media player"),document.querySelector("#mediaplayer").classList.add("hidden"),document.querySelector("#container").classList.remove("hidden"))}function f(){const e=new Date;let t=e.getHours(),s=e.getMinutes();s=g(s);let n=`${e.getDate()}-${e.getMonth()+1}-${e.getFullYear()}`;document.getElementById("clock").innerHTML!=t+":"+s&&(document.getElementById("clock").innerHTML=t+":"+s),document.getElementById("date").innerHTML!=n&&(document.getElementById("date").innerHTML=n)}function g(e){return e<10&&(e="0"+e),e}function y(e,t){let s=Date.parse(e.last_changed),n=!1;(Date.now()-s)/1e3/60>180&&(n=!0),n?document.querySelector(t).classList.add("timedout"):document.querySelector(t).classList.remove("timedout")}function _(e,t){if(0==e)return;let s=document.getElementById("rain"),n="<img src='rain.png' width='70px'>";t>0?n+=`${t}mm/h`:e>0?n+=`${e}mm`:n="",s.innerHTML!=n&&(s.innerHTML=n,""==n?(s.style.display="none",document.getElementById("date").style.display="block"):(s.style.display="block",document.getElementById("date").style.display="none"))}async function v(){u=await(0,r.nP)(window.connection);for(const[e,t]of Object.entries(u))"media_player"==t.entity_id.split(".")[0]&&(entIds[t.entity_id]=t.entity_id)}function b(){let e,t=document.querySelector("#popup .modal-content"),s=["select","switch","remote","button","scene"];for(const[n,o]of Object.entries(u)){e="";let n,i=o.entity_id.split(".")[0];if(s.includes(i)&&"unknown"!=o.state&&"unavailable"!=o.state){if("select"==i){e=`\n                        ${o.attributes.friendly_name}\n                        <select>`;for(let t=0;t<o.attributes.options.length;t++)e+=`<option data-domain='${i}' data-action='${o.attributes.options[t]}' data-id='${o.entity_id}'>${o.attributes.options[t]}</option>`;e+="</select><br>"}else n="on"==o.state?"turn_off":"turn_on",e=`<button data-domain='${i}' data-action='${n}' data-id='${o.entity_id}'>${o.attributes.friendly_name}</button>`;t.querySelector(`#${i}`).insertAdjacentHTML("beforeEnd",e)}}for(let e=0;e<s.length;e++)""==document.querySelector(`#${s[e]}`).innerHTML&&document.querySelector(`#show_${s[e]}`).classList.add("hidden")}window.setupEntitiesSubscription=async()=>{d&&(d(),console.log("Sleeping"),await new Promise((e=>setTimeout(e,4e3)))),d=(0,a.o)(window.connection,(e=>p(window.connection,e)),Object.values(entIds))},null!=TITLE&&""!=TITLE&&(document.querySelector("head title").textContent=TITLE),f(),setInterval(f,6e4),"undefined"!=typeof HA_INSTANCE?(console.log("Logging in with long live access token"),await(async()=>{const e=(0,n.W9)(HA_INSTANCE,HA_SECRET);window.connection=await(0,i.tq)({auth:e})})()):await l(),await v(),b(),setupEntitiesSubscription(),window.scrollTo(0,0),t()}catch(w){t(w)}}),1)},694:(e,t,s)=>{var n=s(815);function o(){document.getElementById("popup").classList.add("hidden")}document.addEventListener("pointerup",function(){let e,t=0;return function(s){const n=(new Date).getTime(),o=n-t;if(0<o&&o<500){s.preventDefault();const e=new CustomEvent("doubletap",{bubbles:!0,detail:s});s.target.dispatchEvent(e)}else e=setTimeout((()=>clearTimeout(e)),500);t=n}}()),document.addEventListener("doubletap",(()=>{document.getElementById("popup").classList.remove("hidden")})),document.addEventListener("click",(async e=>{let t=e.target,s=t.dataset.domain,i=t.dataset.action,r=t.dataset.id;if(null!=t.closest(".modal-close"))document.getElementById("popup").classList.add("hidden"),o();else if(t.matches(".tablink")){let e=document.querySelector(".tablink.active");document.querySelector(`#${e.dataset.target}`).classList.add("hidden"),e.classList.remove("active"),t.classList.add("active"),document.querySelector(`#${t.dataset.target}`).classList.remove("hidden")}null!=i&&((0,n.cb)(window.connection,s,i,{entity_id:r}),"turn_on"==i?t.dataset.action="turn_off":"turn_off"==i&&(t.dataset.action="turn_on"),await new Promise((e=>setTimeout(e,1e3))),o())})),document.addEventListener("change",(e=>{let t=e.target,s=t.options[t.selectedIndex];console.log(s);let o=s.dataset.domain,i=s.dataset.action,r=s.dataset.id;(0,n.cb)(window.connection,o,i,{entity_id:r})}))},739:(e,t,s)=>{s.d(t,{tq:()=>h});var n=s(78),o=s(113),i=s(953);const r=!1,a="auth_required",c="auth_invalid",d="auth_ok";function u(e){if(!e.auth)throw n.p;const t=e.auth;let s=t.expired?t.refreshAccessToken().then((()=>{s=void 0}),(()=>{s=void 0})):void 0;const u=t.wsUrl;function l(e,h,m){r&&console.log("[Auth Phase] New connection",u);const p=new WebSocket(u);let f=!1;const g=()=>{if(p.removeEventListener("close",g),f)return void m(n.Fx);if(0===e)return void m(n.bM);const t=-1===e?-1:e-1;setTimeout((()=>l(t,h,m)),1e3)},y=async e=>{try{t.expired&&await(s||t.refreshAccessToken()),p.send(JSON.stringify(o.j2(t.accessToken)))}catch(e){f=e===n.Fx,p.close()}},_=async e=>{const t=JSON.parse(e.data);switch(r&&console.log("[Auth phase] Received",t),t.type){case c:f=!0,p.close();break;case d:p.removeEventListener("open",y),p.removeEventListener("message",_),p.removeEventListener("close",g),p.removeEventListener("error",g),p.haVersion=t.ha_version,(0,i.Y6)(p.haVersion,2022,9)&&p.send(JSON.stringify(o.gQ())),h(p);break;default:r&&t.type!==a&&console.warn("[Auth phase] Unhandled message",t)}};p.addEventListener("open",y),p.addEventListener("message",_),p.addEventListener("close",g),p.addEventListener("error",g)}return r&&console.log("[Auth phase] Initializing",u),new Promise(((t,s)=>l(e.setupRetry,t,s)))}class l{constructor(e,t){this._handleMessage=e=>{let t=JSON.parse(e.data);Array.isArray(t)||(t=[t]),t.forEach((e=>{const t=this.commands.get(e.id);switch(e.type){case"event":t?t.callback(e.event):(console.warn(`Received event for unknown subscription ${e.id}. Unsubscribing.`),this.sendMessagePromise(o.B1(e.id)).catch((e=>{})));break;case"result":t&&(e.success?(t.resolve(e.result),"subscribe"in t||this.commands.delete(e.id)):(t.reject(e.error),this.commands.delete(e.id)));break;case"pong":t?(t.resolve(),this.commands.delete(e.id)):console.warn(`Received unknown pong response ${e.id}`)}}))},this._handleClose=async()=>{const e=this.commands;if(this.commandId=1,this.oldSubscriptions=this.commands,this.commands=new Map,this.socket=void 0,e.forEach((e=>{"subscribe"in e||e.reject(o.z3(n.UD,"Connection lost"))})),this.closeRequested)return;this.fireEvent("disconnected");const t=Object.assign(Object.assign({},this.options),{setupRetry:0}),s=e=>{setTimeout((async()=>{if(!this.closeRequested)try{const e=await t.createSocket(t);this._setSocket(e)}catch(t){if(this._queuedMessages){const e=this._queuedMessages;this._queuedMessages=void 0;for(const t of e)t.reject&&t.reject(n.UD)}t===n.Fx?this.fireEvent("reconnect-error",t):s(e+1)}}),1e3*Math.min(e,5))};this.suspendReconnectPromise&&(await this.suspendReconnectPromise,this.suspendReconnectPromise=void 0,this._queuedMessages=[]),s(0)},this.options=t,this.commandId=2,this.commands=new Map,this.eventListeners=new Map,this.closeRequested=!1,this._setSocket(e)}get connected(){return void 0!==this.socket&&this.socket.readyState==this.socket.OPEN}_setSocket(e){this.socket=e,this.haVersion=e.haVersion,e.addEventListener("message",this._handleMessage),e.addEventListener("close",this._handleClose);const t=this.oldSubscriptions;t&&(this.oldSubscriptions=void 0,t.forEach((e=>{"subscribe"in e&&e.subscribe&&e.subscribe().then((t=>{e.unsubscribe=t,e.resolve()}))})));const s=this._queuedMessages;if(s){this._queuedMessages=void 0;for(const e of s)e.resolve()}this.fireEvent("ready")}addEventListener(e,t){let s=this.eventListeners.get(e);s||(s=[],this.eventListeners.set(e,s)),s.push(t)}removeEventListener(e,t){const s=this.eventListeners.get(e);if(!s)return;const n=s.indexOf(t);-1!==n&&s.splice(n,1)}fireEvent(e,t){(this.eventListeners.get(e)||[]).forEach((e=>e(this,t)))}suspendReconnectUntil(e){this.suspendReconnectPromise=e}suspend(){if(!this.suspendReconnectPromise)throw new Error("Suspend promise not set");this.socket&&this.socket.close()}reconnect(e=!1){this.socket&&(e?(this.socket.removeEventListener("message",this._handleMessage),this.socket.removeEventListener("close",this._handleClose),this.socket.close(),this._handleClose()):this.socket.close())}close(){this.closeRequested=!0,this.socket&&this.socket.close()}async subscribeEvents(e,t){return this.subscribeMessage(e,o.ku(t))}ping(){return this.sendMessagePromise(o.hU())}sendMessage(e,t){if(!this.connected)throw n.UD;if(this._queuedMessages){if(t)throw new Error("Cannot queue with commandId");this._queuedMessages.push({resolve:()=>this.sendMessage(e)})}else t||(t=this._genCmdId()),e.id=t,this.socket.send(JSON.stringify(e))}sendMessagePromise(e){return new Promise(((t,s)=>{if(this._queuedMessages)return void this._queuedMessages.push({reject:s,resolve:async()=>{try{t(await this.sendMessagePromise(e))}catch(e){s(e)}}});const n=this._genCmdId();this.commands.set(n,{resolve:t,reject:s}),this.sendMessage(e,n)}))}async subscribeMessage(e,t,s){let n;return this._queuedMessages&&await new Promise(((e,t)=>{this._queuedMessages.push({resolve:e,reject:t})})),await new Promise(((i,r)=>{const a=this._genCmdId();n={resolve:i,reject:r,callback:e,subscribe:!1!==(null==s?void 0:s.resubscribe)?()=>this.subscribeMessage(e,t):void 0,unsubscribe:async()=>{this.connected&&await this.sendMessagePromise(o.B1(a)),this.commands.delete(a)}},this.commands.set(a,n);try{this.sendMessage(t,a)}catch(e){}})),()=>n.unsubscribe()}_genCmdId(){return++this.commandId}}async function h(e){const t=Object.assign({setupRetry:0,createSocket:u},e),s=await t.createSocket(t);return new l(s,t)}},815:(e,t,s)=>{s.d(t,{cb:()=>r,nP:()=>o,wz:()=>i});var n=s(113);const o=e=>e.sendMessagePromise(n.xP()),i=e=>e.sendMessagePromise(n.kQ()),r=(e,t,s,o,i,r)=>e.sendMessagePromise(n.cb(t,s,o,i,r))},893:(e,t,s)=>{s.d(t,{o:()=>u});const n=e=>{let t=[];function s(s,n){e=n?s:Object.assign(Object.assign({},e),s);let o=t;for(let t=0;t<o.length;t++)o[t](e)}return{get state(){return e},action(t){function n(e){s(e,!1)}return function(){let s=[e];for(let e=0;e<arguments.length;e++)s.push(arguments[e]);let o=t.apply(this,s);if(null!=o)return o instanceof Promise?o.then(n):n(o)}},setState:s,clearState(){e=void 0},subscribe:e=>(t.push(e),()=>{!function(e){let s=[];for(let n=0;n<t.length;n++)t[n]===e?e=null:s.push(t[n]);t=s}(e)})}},o=(e,t,s,o,i={unsubGrace:!0,entity_ids:[]})=>{if(e[t])return e[t];let r,a,c=0,d=n();const u=()=>{if(!s)throw new Error("Collection does not support refresh");return s(e).then((e=>d.setState(e,!0)))},l=()=>u().catch((t=>{if(e.connected)throw t})),h=()=>{a=void 0,r&&r.then((e=>{e()})),d.clearState(),e.removeEventListener("ready",u),e.removeEventListener("disconnected",m)},m=()=>{a&&(clearTimeout(a),h())};return e[t]={get state(){return d.state},refresh:u,subscribe(t){c++,1===c&&(()=>{if(void 0!==a)return clearTimeout(a),void(a=void 0);o&&(r=o(e,d,i.entity_ids)),s&&(e.addEventListener("ready",l),l()),e.addEventListener("disconnected",m)})();const n=d.subscribe(t);return void 0!==d.state&&setTimeout((()=>t(d.state)),0),()=>{n(),c--,c||(i.unsubGrace?a=setTimeout(h,5e3):h())}}},e[t]};var i=s(815),r=s(953);const a=(e,t,s=[])=>{e.subscribeMessage((e=>function(e,t){const s=Object.assign({},e.state);if(t.a)for(const e in t.a){const n=t.a[e];let o=new Date(1e3*n.lc).toISOString();s[e]={entity_id:e,state:n.s,attributes:n.a,context:"string"==typeof n.c?{id:n.c,parent_id:null,user_id:null}:n.c,last_changed:o,last_updated:n.lu?new Date(1e3*n.lu).toISOString():o}}if(t.r)for(const e of t.r)delete s[e];if(t.c)for(const e in t.c){let n=s[e];if(!n){console.warn("Received state update for unknown entity",e);continue}n=Object.assign({},n);const{"+":o,"-":i}=t.c[e],r=(null==o?void 0:o.a)||(null==i?void 0:i.a),a=r?Object.assign({},n.attributes):n.attributes;if(o&&(void 0!==o.s&&(n.state=o.s),o.c&&("string"==typeof o.c?n.context=Object.assign(Object.assign({},n.context),{id:o.c}):n.context=Object.assign(Object.assign({},n.context),o.c)),o.lc?n.last_updated=n.last_changed=new Date(1e3*o.lc).toISOString():o.lu&&(n.last_updated=new Date(1e3*o.lu).toISOString()),o.a&&Object.assign(a,o.a)),null==i?void 0:i.a)for(const e of i.a)delete a[e];r&&(n.attributes=a),s[e]=n}e.setState(s,!0)}(t,e)),{type:"subscribe_entities",entity_ids:s})};async function c(e){const t=await(0,i.nP)(e),s={};for(let e=0;e<t.length;e++){const n=t[e];s[n.entity_id]=n}return s}const d=(e,t)=>e.subscribeEvents((e=>function(e,t){const s=e.state;if(void 0===s)return;const{entity_id:n,new_state:o}=t.data;if(o)e.setState({[o.entity_id]:o});else{const t=Object.assign({},s);delete t[n],e.setState(t,!0)}}(t,e)),"state_changed"),u=(e,t,s=[])=>((e,t=[])=>(0,r.Y6)(e.haVersion,2022,4,0)?o(e,"_ent",void 0,a,{unsubGrace:!0,entity_ids:t}):o(e,"_ent",c,d))(e,s).subscribe(t)},953:(e,t,s)=>{function n(e){const t={},s=e.split("&");for(let e=0;e<s.length;e++){const n=s[e].split("="),o=decodeURIComponent(n[0]),i=n.length>1?decodeURIComponent(n[1]):void 0;t[o]=i}return t}s.d(t,{Y6:()=>o,mA:()=>n});const o=(e,t,s,n)=>{const[o,i,r]=e.split(".",3);return Number(o)>t||Number(o)===t&&(void 0===n?Number(i)>=s:Number(i)>s)||void 0!==n&&Number(o)===t&&Number(i)===s&&Number(r)>=n}}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={exports:{}};return o[e](s,s.exports,r),s.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",s="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},r.a=(o,i,r)=>{var a;r&&((a=[]).d=-1);var c,d,u,l=new Set,h=o.exports,m=new Promise(((e,t)=>{u=t,d=e}));m[t]=h,m[e]=e=>(a&&e(a),l.forEach(e),m.catch((e=>{}))),o.exports=m,i((o=>{var i;c=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[e])return o;if(o.then){var i=[];i.d=0,o.then((e=>{r[t]=e,n(i)}),(e=>{r[s]=e,n(i)}));var r={};return r[e]=e=>e(i),r}}var a={};return a[e]=e=>{},a[t]=o,a})))(o);var r=()=>c.map((e=>{if(e[s])throw e[s];return e[t]})),d=new Promise((t=>{(i=()=>t(r)).r=0;var s=e=>e!==a&&!l.has(e)&&(l.add(e),e&&!e.d&&(i.r++,e.push(i)));c.map((t=>t[e](s)))}));return i.r?d:r()}),(e=>(e?u(m[s]=e):d(h),n(a)))),a&&a.d<0&&(a.d=0)},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(564)})();
//# sourceMappingURL=main.min.js.map